# Token Budget Distribution Analysis

**Date**: 2026-02-09
**Analyst**: context-engineer
**Project**: ai-assistants
**Budget ceiling**: ~8,500 tokens (~29,750 chars) for always-loaded content

---

## Executive Summary

The always-loaded context consumes **~33,782 characters (~9,652 tokens)**, exceeding the stated 8,500-token budget ceiling by **~13.5%**. The single largest contributor is the `software-agents-usage.md` rule at 8,719 chars (25.8% of always-loaded total), followed by `readme-style.md` (14.0%) and `coding-style.md` (13.3%).

On-demand artifacts are well-structured with progressive disclosure. However, three skills exceed 15,000 chars for their SKILL.md alone (`skill-crafting` at 16,672, `software-planning` at 17,085), and `python-prj-mgmt` has the largest total footprint at 35,389 chars when all reference files are loaded.

The worst-case scenario (baseline + 4 skills + agent pipeline) would consume an estimated **~56,000 tokens** of context window capacity.

---

## 1. Always-Loaded Artifacts

These are injected into every Claude Code conversation for this project.

### 1.1 Detailed Breakdown

| Artifact | File | Chars | Est. Tokens | % of Always-Loaded |
|----------|------|------:|------------:|--------------------:|
| **Global CLAUDE.md** | `~/.claude/CLAUDE.md` | 2,697 | 771 | 8.0% |
| **Project CLAUDE.md** | `CLAUDE.md` | 3,086 | 882 | 9.1% |
| **Rule: software-agents-usage** | `rules/swe/software-agents-usage.md` | 8,719 | 2,491 | 25.8% |
| **Rule: readme-style** | `rules/writing/readme-style.md` | 4,719 | 1,348 | 14.0% |
| **Rule: coding-style** | `rules/swe/coding-style.md` | 4,505 | 1,287 | 13.3% |
| **Rule: agent-intermediate-documents** | `rules/swe/agent-intermediate-documents.md` | 3,903 | 1,115 | 11.6% |
| **Rule: git-commit-hygiene** | `rules/swe/vcs/git-commit-hygiene.md` | 1,134 | 324 | 3.4% |
| **Rule: git-commit-message-format** | `rules/swe/vcs/git-commit-message-format.md` | 950 | 271 | 2.8% |
| **userPreferences.txt** | `~/.claude/userPreferences.txt` | 2,143 | 612 | 6.3% |
| **Project Memory** | `projects/.../memory/MEMORY.md` | 1,926 | 550 | 5.7% |
| | | | | |
| **TOTAL** | | **33,782** | **~9,652** | **100%** |

### 1.2 Budget Analysis

| Metric | Value |
|--------|-------|
| Budget ceiling (chars) | 29,750 |
| Budget ceiling (tokens) | ~8,500 |
| Actual usage (chars) | 33,782 |
| Actual usage (tokens) | ~9,652 |
| **Over budget by** | **~4,032 chars / ~1,152 tokens (13.5%)** |

**Note on `userPreferences.txt`**: This file (2,143 chars) is loaded by Claude Code as part of user preferences. Whether it counts against the "always-loaded context artifacts" budget is debatable -- it is a Claude platform feature, not a project artifact. Excluding it brings the total to **31,639 chars (~9,040 tokens)**, still **6.3% over budget**.

### 1.3 Category Distribution

| Category | Chars | Est. Tokens | % of Total |
|----------|------:|------------:|-----------:|
| Rules (6 files) | 23,930 | 6,837 | 70.8% |
| CLAUDE.md files (2) | 5,783 | 1,652 | 17.1% |
| userPreferences.txt | 2,143 | 612 | 6.3% |
| Project Memory | 1,926 | 550 | 5.7% |

Rules dominate at **70.8%** of the always-loaded budget. The `software-agents-usage.md` rule alone consumes more than both CLAUDE.md files combined.

### 1.4 Implicit Always-Loaded: Skill & Command Metadata

Claude Code injects a skill/command listing block into the system prompt for activation decisions. This is NOT counted in the budget above because it is generated by the platform, but it consumes context window space.

| Metadata Type | Est. Chars | Est. Tokens |
|---------------|----------:|------------:|
| Skill descriptions (11 skills + 7 commands) | ~5,100 | ~1,457 |
| Agent descriptions (9 agents, ~50 words each) | ~2,700 | ~771 |
| **Subtotal** | **~7,800** | **~2,229** |

Including this platform overhead, the effective always-loaded footprint is **~41,582 chars (~11,880 tokens)**.

---

## 2. On-Demand Artifacts: Skills

Skills load their SKILL.md when activated. Reference/satellite files load on further demand.

### 2.1 Skill Size Catalog

| Skill | SKILL.md (chars) | SKILL.md (tokens) | Reference Files (chars) | Total with Refs (chars) | Total Tokens |
|-------|-----------------:|-------------------:|------------------------:|------------------------:|-------------:|
| software-planning | 17,085 | 4,881 | 10,197 | 27,282 | 7,795 |
| skill-crafting | 16,672 | 4,763 | 10,153 | 26,825 | 7,664 |
| python-development | 11,260 | 3,217 | 0 | 11,260 | 3,217 |
| rule-crafting | 11,080 | 3,166 | 7,987 | 19,067 | 5,448 |
| doc-management | 11,103 | 3,172 | 15,559 | 26,662 | 7,618 |
| mcp-crafting | 9,335 | 2,667 | 23,269 | 32,604 | 9,315 |
| agent-crafting | 8,668 | 2,477 | 13,693 | 22,361 | 6,389 |
| python-prj-mgmt | 7,066 | 2,019 | 28,323 | 35,389 | 10,111 |
| refactoring | 7,078 | 2,022 | 5,309 | 12,387 | 3,539 |
| command-crafting | 7,261 | 2,075 | 4,187 | 11,448 | 3,271 |
| code-review | 5,015 | 1,433 | 2,174 | 7,189 | 2,054 |

### 2.2 Skill Size Distribution

**Largest SKILL.md files** (activation-time cost):
1. `software-planning` -- 17,085 chars (4,881 tokens)
2. `skill-crafting` -- 16,672 chars (4,763 tokens)
3. `python-development` -- 11,260 chars (3,217 tokens)

**Largest total footprints** (SKILL.md + all references):
1. `python-prj-mgmt` -- 35,389 chars (10,111 tokens) -- driven by `pixi.md` (16,025) and `uv.md` (12,298)
2. `mcp-crafting` -- 32,604 chars (9,315 tokens)
3. `software-planning` -- 27,282 chars (7,795 tokens)

**Smallest** (most token-efficient):
1. `code-review` -- 7,189 chars total (2,054 tokens)
2. `command-crafting` -- 11,448 chars total (3,271 tokens)
3. `refactoring` -- 12,387 chars total (3,539 tokens)

### 2.3 Progressive Disclosure Effectiveness

| Skill | SKILL.md % of Total | References % | Disclosure Ratio |
|-------|--------------------:|-------------:|-----------------:|
| python-prj-mgmt | 20.0% | 80.0% | Excellent -- 80% deferred |
| mcp-crafting | 28.6% | 71.4% | Excellent |
| agent-crafting | 38.8% | 61.2% | Good |
| doc-management | 41.6% | 58.4% | Good |
| rule-crafting | 58.1% | 41.9% | Moderate |
| skill-crafting | 62.2% | 37.8% | Moderate |
| software-planning | 62.6% | 37.4% | Moderate |
| refactoring | 57.1% | 42.9% | Moderate |
| command-crafting | 63.4% | 36.6% | Moderate |
| code-review | 69.8% | 30.2% | Low -- most content in SKILL.md |
| python-development | 100.0% | 0.0% | None -- no reference files |

---

## 3. On-Demand Artifacts: Commands

| Command | Chars | Est. Tokens |
|---------|------:|------------:|
| add-rules | 2,064 | 590 |
| create-simple-python-prj | 1,564 | 447 |
| manage-readme | 1,306 | 373 |
| cop | 786 | 225 |
| co | 726 | 207 |
| merge-worktree | 631 | 180 |
| create-worktree | 553 | 158 |
| **Total** | **7,630** | **~2,180** |

Commands are compact. The entire command catalog is smaller than any single skill.

---

## 4. On-Demand Artifacts: Agents

Agent definitions load only in spawned context windows, NOT in the parent conversation. They carry their own context budget.

### 4.1 Agent Definition Sizes

| Agent | Chars | Est. Tokens |
|-------|------:|------------:|
| promethean | 15,496 | 4,427 |
| context-engineer | 15,361 | 4,389 |
| sentinel | 14,118 | 4,034 |
| implementation-planner | 13,920 | 3,977 |
| systems-architect | 11,503 | 3,287 |
| doc-engineer | 10,222 | 2,920 |
| researcher | 10,178 | 2,908 |
| verifier | 9,639 | 2,754 |
| implementer | 7,518 | 2,148 |
| **Total** | **107,955** | **~30,844** |

**Agent reference file**: `agents/references/sentinel-checks.md` -- 9,038 chars (2,582 tokens). Loaded by the sentinel agent on demand.

### 4.2 Agent Memory Files

Each agent has a persistent MEMORY.md loaded into its spawned context window.

| Agent | Memory Chars | Memory Tokens |
|-------|------------:|-------------:|
| implementation-planner | 4,683 | 1,338 |
| researcher | 3,453 | 987 |
| verifier | 2,429 | 694 |
| context-engineer | 2,170 | 620 |
| promethean | 1,597 | 456 |
| sentinel | 1,560 | 446 |
| systems-architect | 1,516 | 433 |
| doc-engineer | 1,107 | 316 |
| implementer | 768 | 219 |
| **Total** | **19,283** | **~5,509** |

### 4.3 Agent Spawned Context Budget

When an agent spawns, its context includes: baseline always-loaded + agent definition + agent memory + any skills it uses.

| Agent | Definition | Memory | Skills | Est. Total (tokens) |
|-------|----------:|-------:|-------:|--------------------:|
| implementer | 2,148 | 219 | ~10,120 (3 skills) | ~22,139 |
| sentinel | 4,034 | 446 | 0 | ~14,132 |
| context-engineer | 4,389 | 620 | varies | ~14,661+ |
| researcher | 2,908 | 987 | 0 | ~13,547 |
| promethean | 4,427 | 456 | 0 | ~14,535 |

Note: These estimates include the ~9,652 baseline always-loaded tokens.

---

## 5. System Overhead

| Component | Chars | Tokens | Loading Behavior |
|-----------|------:|-------:|------------------|
| `plugin.json` | 1,216 | 347 | Parsed at plugin install; metadata extracted for runtime |
| `settings.local.json` | 16,821 | 4,806 | Parsed by Claude Code for permissions; not injected into context |
| `claude_desktop_config.json` | 993 | 284 | Claude Desktop only; MCP server config |
| `PLUGIN_SCHEMA_NOTES.md` | 3,745 | 1,070 | Never auto-loaded; reference doc |

**MCP tool descriptions**: The task-chronograph MCP server registers tools whose descriptions are injected into the context. Exact size depends on the number of tools exposed by the server -- not measured here as it requires a running server instance.

---

## 6. Usage Pattern Scenarios

### Scenario 1: Baseline (Always-Loaded Only)

The minimum context footprint for any conversation in this project.

| Component | Tokens |
|-----------|-------:|
| CLAUDE.md files (2) | 1,652 |
| Rules (6) | 6,837 |
| userPreferences.txt | 612 |
| Project Memory | 550 |
| Skill/command/agent metadata | ~2,229 |
| **Total** | **~11,880** |

### Scenario 2: Single Skill Activation (Baseline + code-review)

A lightweight review session using the smallest skill.

| Component | Tokens |
|-----------|-------:|
| Baseline | 11,880 |
| code-review SKILL.md | 1,433 |
| **Total** | **~13,313** |

### Scenario 3: Pipeline Execution (Researcher -> Architect -> Planner)

Each agent runs in a separate context window. The parent conversation just tracks progress.

**Parent conversation:**
| Component | Tokens |
|-----------|-------:|
| Baseline | 11,880 |
| Pipeline document reads (RESEARCH_FINDINGS, SYSTEMS_PLAN, etc.) | ~3,000-8,000 |
| **Total** | **~15,000-20,000** |

**Per spawned agent (approximate):**
| Agent | Baseline | Definition | Memory | Skills | Total |
|-------|-------:|----------:|-------:|-------:|------:|
| researcher | 9,652 | 2,908 | 987 | 0 | ~13,547 |
| systems-architect | 9,652 | 3,287 | 433 | 0 | ~13,372 |
| implementation-planner | 9,652 | 3,977 | 1,338 | ~4,881 | ~19,848 |

### Scenario 4: Heavy Skill Session (Baseline + 3 Skills)

A Python development session using python-development, python-prj-mgmt (with pixi ref), and refactoring.

| Component | Tokens |
|-----------|-------:|
| Baseline | 11,880 |
| python-development SKILL.md | 3,217 |
| python-prj-mgmt SKILL.md | 2,019 |
| python-prj-mgmt/pixi.md (reference) | 4,579 |
| refactoring SKILL.md | 2,022 |
| **Total** | **~23,717** |

### Scenario 5: Full Context Pressure (Worst Case)

Baseline + 4 skills activated with all references + pipeline documents in conversation.

| Component | Tokens |
|-----------|-------:|
| Baseline | 11,880 |
| skill-crafting (full) | 7,664 |
| agent-crafting (full) | 6,389 |
| rule-crafting (full) | 5,448 |
| command-crafting (full) | 3,271 |
| Pipeline docs in conversation | ~5,000 |
| Conversation history | ~15,000+ |
| **Total** | **~54,652+** |

This approaches significant context window utilization but remains well within Claude's 200k context limit.

---

## 7. Optimization Opportunities

### 7.1 Critical: Always-Loaded Budget Exceeded

**Finding**: The always-loaded content is at 33,782 chars (~9,652 tokens), exceeding the 29,750 char / 8,500 token ceiling by 13.5%.

**Top candidates for reduction:**

| Rule | Current Chars | Reduction Target | Approach |
|------|-------------:|----------------:|----------|
| `software-agents-usage.md` | 8,719 | ~6,500 | Move the Coordination Pipeline diagram and Parallel Execution details to `references/agent-coordination-protocols.md` (already exists but is not symlinked as a rule -- it is a reference file) |
| `readme-style.md` | 4,719 | ~3,500 | Condense Mandatory Exclusions and Structural Integrity sections; some content overlaps with the doc-management skill |
| `agent-intermediate-documents.md` | 3,903 | ~3,000 | The Document Lifecycle table and Version Control section are verbose for declarative domain knowledge |

Reducing these three rules by a combined ~4,000 chars would bring the total under budget.

### 7.2 Important: Skills Lacking Progressive Disclosure

| Skill | SKILL.md Size | Issue |
|-------|-------------:|-------|
| `python-development` | 11,260 | No reference files at all -- entire skill loads at activation |
| `software-planning` | 17,085 | 62.6% in SKILL.md; the phases/ and contexts/ refs are small relative to the main file |
| `skill-crafting` | 16,672 | 62.2% in SKILL.md; large for a single activation |

**Recommendation**: Extract sections from `python-development` and `software-planning` SKILL.md files into reference files to improve progressive disclosure ratios.

### 7.3 Suggested: Reference File Sizes

| Reference File | Chars | Issue |
|----------------|------:|-------|
| `python-prj-mgmt/pixi.md` | 16,025 | Largest single reference file; consider splitting into quick-ref + full-ref |
| `python-prj-mgmt/uv.md` | 12,298 | Large but acceptable for a comprehensive tool guide |
| `mcp-crafting/contexts/python.md` | 10,549 | Large context module |

### 7.4 Suggested: Memory File Growth

Project memory (1,926 chars) is modest, but agent memories total 19,283 chars across 9 agents. The `implementation-planner` memory at 4,683 chars is the largest. Periodically review agent memories for staleness to prevent unbounded growth.

---

## 8. Artifact Ecosystem Summary

### Total Content Inventory

| Category | Files | Total Chars | Total Tokens |
|----------|------:|------------:|-------------:|
| Always-loaded (CLAUDE.md + rules + prefs + memory) | 10 | 33,782 | ~9,652 |
| Skills (SKILL.md only) | 11 | 111,623 | ~31,892 |
| Skill references | 17 | 120,856 | ~34,530 |
| Commands | 7 | 7,630 | ~2,180 |
| Agent definitions | 9 | 107,955 | ~30,844 |
| Agent reference | 1 | 9,038 | ~2,582 |
| Agent memories | 9 | 19,283 | ~5,509 |
| System files | 4 | 22,775 | ~6,507 |
| **Grand Total** | **68** | **~432,942** | **~123,698** |

### Budget Utilization Visual

```
Always-Loaded Budget: 29,750 chars (8,500 tokens)
Actual Usage:         33,782 chars (9,652 tokens)

[====================|====] 113.5%
                     ^
                     Budget ceiling

Breakdown:
Rules          [==============]  70.8%  (23,930 chars)
CLAUDE.md      [===]             17.1%  ( 5,783 chars)
userPrefs      [=]                6.3%  ( 2,143 chars)
Memory         [=]                5.7%  ( 1,926 chars)
```

---

## 9. Methodology Notes

- **Character counts**: `wc -c` on each file (exact byte counts)
- **Token estimation**: chars / 3.5 (standard approximation for English text with markdown formatting)
- **Always-loaded scope**: Files confirmed present in the system-reminder injection of this conversation: global CLAUDE.md, project CLAUDE.md, 6 rules (symlinked from `~/.claude/rules/`), userPreferences.txt, and project MEMORY.md
- **Rules reference file**: `rules/swe/references/agent-coordination-protocols.md` (5,415 chars) is NOT symlinked into `~/.claude/rules/` and is NOT always-loaded -- it is a reference file loaded on demand when rules reference it
- **Rules README**: `rules/README.md` (10,983 chars) is NOT installed as a rule and NOT always-loaded
- **Skill metadata**: The ~5,100 char skill listing in system prompts is platform-generated overhead, not counted in the artifact budget

**Regeneration note**: This report should be regenerated after major context artifact changes (new rules, skill restructuring, CLAUDE.md edits). Run the context-engineer with the same analysis task to produce an updated snapshot.
